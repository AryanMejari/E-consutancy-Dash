<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shabdaanjali - Policy Consultation Analysis</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        :root {
            --primary: #1a73e8;
            --primary-dark: #0d47a1;
            --secondary: #34a853;
            --danger: #ea4335;
            --warning: #fbbc04;
            --light: #f8f9fa;
            --dark: #202124;
            --gray: #5f6368;
            --light-gray: #dadce0;
            --sidebar-width: 250px;
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f5f7f9;
            color: var(--dark);
            line-height: 1.6;
        }
        
        /* Login Page Styles */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #1a73e8 0%, #0d47a1 100%);
        }
        
        .login-form {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            width: 100%;
            max-width: 400px;
        }
        
        .login-form h2 {
            text-align: center;
            margin-bottom: 20px;
            color: var(--dark);
            font-family: 'Poppins', sans-serif;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        .form-group input {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--light-gray);
            border-radius: 4px;
            font-size: 16px;
        }
        
        .login-btn {
            width: 100%;
            padding: 12px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .login-btn:hover {
            background: var(--primary-dark);
        }
        
        .form-switch {
            text-align: center;
            margin-top: 20px;
            font-size: 14px;
        }
        
        .form-switch a {
            color: var(--primary);
            text-decoration: none;
            cursor: pointer;
        }
        
        /* User Complaint Form */
        .complaint-form {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
        }
        
        .complaint-form h3 {
            margin-bottom: 20px;
            font-family: 'Poppins', sans-serif;
        }
        
        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-half {
            flex: 1;
        }
        
        textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--light-gray);
            border-radius: 4px;
            resize: vertical;
            min-height: 120px;
        }
        
        .file-upload {
            border: 2px dashed var(--light-gray);
            padding: 20px;
            text-align: center;
            border-radius: 8px;
            margin-bottom: 20px;
            cursor: pointer;
        }
        
        .file-upload:hover {
            border-color: var(--primary);
        }
        
        .file-list {
            margin-top: 15px;
        }
        
        .file-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: var(--light);
            border-radius: 4px;
            margin-bottom: 8px;
        }
        
        .file-remove {
            color: var(--danger);
            cursor: pointer;
        }
        
        /* Admin Dashboard */
        .app-container {
            display: flex;
            min-height: 100vh;
        }
        
        /* Sidebar Styles */
        .sidebar {
            width: var(--sidebar-width);
            background: var(--dark);
            color: white;
            padding: 20px 0;
            transition: var(--transition);
            position: fixed;
            height: 100vh;
            z-index: 100;
        }
        
        .logo {
            padding: 0 20px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 20px;
        }
        
        .logo h1 {
            font-family: 'Poppins', sans-serif;
            font-size: 22px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo span {
            color: var(--primary);
        }
        
        .menu-item {
            padding: 12px 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .menu-item:hover, .menu-item.active {
            background: rgba(255, 255, 255, 0.1);
            border-left: 4px solid var(--primary);
        }
        
        /* Main Content Styles */
        .main-content {
            flex: 1;
            padding: 20px;
            margin-left: var(--sidebar-width);
            transition: var(--transition);
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--light-gray);
        }
        
        .header h2 {
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            color: var(--dark);
        }
        
        .consultation-info {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        
        /* Dashboard Cards */
        .dashboard-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            transition: transform 0.2s;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .stat-card {
            display: flex;
            flex-direction: column;
        }
        
        .stat-card .value {
            font-size: 28px;
            font-weight: 700;
            margin: 10px 0;
        }
        
        .stat-card .label {
            color: var(--gray);
            font-size: 14px;
        }
        
        .stat-card .trend {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 14px;
            margin-top: 5px;
        }
        
        .trend.up {
            color: var(--secondary);
        }
        
        .trend.down {
            color: var(--danger);
        }
        
        /* Charts */
        .chart-container {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        
        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .chart-title {
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            font-size: 18px;
        }
        
        .chart-actions {
            display: flex;
            gap: 10px;
        }
        
        .btn {
            padding: 8px 16px;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            transition: var(--transition);
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--primary-dark);
        }
        
        .btn-outline {
            background: transparent;
            border: 1px solid var(--light-gray);
            color: var(--gray);
        }
        
        .btn-outline:hover {
            background: var(--light);
        }
        
        /* Comment List */
        .comments-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        
        .filters {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .filter-label {
            font-size: 12px;
            color: var(--gray);
        }
        
        select, input {
            padding: 8px 12px;
            border-radius: 4px;
            border: 1px solid var(--light-gray);
            background: white;
        }
        
        .comment {
            border: 1px solid var(--light-gray);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            background: var(--light);
            transition: var(--transition);
        }
        
        .comment:hover {
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.08);
        }
        
        .comment-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .comment-source {
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .key-stakeholder {
            background: var(--primary);
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 12px;
            margin-left: 10px;
        }
        
        .comment-sentiment {
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 12px;
        }
        
        .sentiment-negative {
            background: #ffebee;
            color: var(--danger);
        }
        
        .sentiment-positive {
            background: #e6f4ea;
            color: var(--secondary);
        }
        
        .sentiment-neutral {
            background: #fef7e0;
            color: var(--warning);
        }
        
        .comment-clause {
            font-size: 14px;
            color: var(--gray);
            margin-bottom: 10px;
        }
        
        .comment-text {
            margin-bottom: 10px;
            line-height: 1.5;
        }
        
        .comment-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
        }
        
        .comment-type {
            display: flex;
            gap: 10px;
        }
        
        .type-badge {
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 12px;
        }
        
        .type-actionable {
            background: #e6f4ea;
            color: var(--secondary);
        }
        
        .type-complaint {
            background: #ffebee;
            color: var(--danger);
        }
        
        .campaign-badge {
            background: #e8f0fe;
            color: var(--primary);
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
        }
        
        .comment-actions {
            display: flex;
            gap: 10px;
        }
        
        .action-btn {
            background: transparent;
            border: none;
            cursor: pointer;
            color: var(--gray);
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 3px;
            transition: var(--transition);
        }
        
        .action-btn:hover {
            color: var(--primary);
        }
        
        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background-color: white;
            padding: 25px;
            border-radius: 8px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--gray);
        }
        
        /* Analysis tags */
        .analysis-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 15px 0;
        }
        
        .analysis-tag {
            padding: 5px 10px;
            background: #e8f0fe;
            border-radius: 20px;
            font-size: 12px;
            color: var(--primary);
        }
        
        /* Responsive */
        @media (max-width: 992px) {
            .dashboard-cards {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .form-row {
                flex-direction: column;
                gap: 0;
            }
        }
        
        @media (max-width: 768px) {
            .dashboard-cards {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                width: 70px;
                transform: translateX(-70px);
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
            
            .main-content {
                margin-left: 0;
            }
            
            .logo h1 span, .menu-item span {
                display: none;
            }
            
            .menu-item {
                justify-content: center;
            }
            
            .menu-toggle {
                display: block;
            }
            
            .filters {
                flex-direction: column;
            }
        }
        
        .menu-toggle {
            display: none;
            position: fixed;
            top: 15px;
            left: 15px;
            z-index: 101;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 8px 12px;
            cursor: pointer;
        }
        
        @media (max-width: 768px) {
            .menu-toggle {
                display: block;
            }
        }
        
        .pagination {
            display: flex;
            justify-content: center;
            margin-top: 20px;
            gap: 8px;
        }
        
        .page-btn {
            padding: 8px 12px;
            background: white;
            border: 1px solid var(--light-gray);
            border-radius: 4px;
            cursor: pointer;
        }
        
        .page-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        /* User Dashboard */
        .user-dashboard {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .user-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .complaint-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        
        .complaint-status {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 14px;
            margin-bottom: 10px;
        }
        
        .status-pending {
            background: #fef7e0;
            color: var(--warning);
        }
        
        .status-reviewed {
            background: #e6f4ea;
            color: var(--secondary);
        }
        
        .status-rejected {
            background: #ffebee;
            color: var(--danger);
        }
        
        /* Admin Analytics */
        .analytics-summary {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .summary-item {
            padding: 15px;
            border-left: 4px solid var(--primary);
            background: #f8f9fa;
        }
        
        .ai-insight {
            background: #e8f0fe;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        
        .hidden {
            display: none;
        }
        /* Add these styles to the existing CSS */

/* Consultation Management Styles */
.consultation-list {
    display: flex;
    flex-direction: column;
    gap: 20px;
}

.consultation-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
}

.consultation-header h3 {
    margin: 0;
}

.status-badge {
    padding: 5px 10px;
    border-radius: 4px;
    font-size: 12px;
    font-weight: 500;
}

.status-badge.active {
    background: #e6f4ea;
    color: #34a853;
}

.status-badge.upcoming {
    background: #e8f0fe;
    color: #1a73e8;
}

.status-badge.completed {
    background: #f1f3f4;
    color: #5f6368;
}

.consultation-details {
    margin-bottom: 15px;
}

.consultation-details p {
    margin: 5px 0;
    font-size: 14px;
}

.consultation-actions {
    display: flex;
    gap: 10px;
}

/* Stakeholder Management Styles */
.stakeholder-card {
    margin-bottom: 20px;
}

.stakeholder-header {
    display: flex;
    gap: 15px;
    margin-bottom: 15px;
}

.stakeholder-avatar img {
    width: 60px;
    height: 60px;
    border-radius: 50%;
}

.stakeholder-info h3 {
    margin: 0 0 5px 0;
}

.stakeholder-info p {
    margin: 0 0 10px 0;
    color: var(--gray);
}

.stakeholder-tags {
    display: flex;
    gap: 5px;
}

.tag {
    padding: 3px 8px;
    background: #e8f0fe;
    color: var(--primary);
    border-radius: 4px;
    font-size: 12px;
}

.stakeholder-details {
    margin-bottom: 15px;
}

.stakeholder-details p {
    margin: 5px 0;
    font-size: 14px;
    display: flex;
    align-items: center;
    gap: 8px;
}

.stakeholder-actions {
    display: flex;
    gap: 10px;
}

.header-actions {
    display: flex;
    gap: 10px;
}

/* Modal footer styles */
.modal-footer {
    display: flex;
    justify-content: flex-end;
    gap: 10px;
    margin-top: 20px;
    padding-top: 15px;
    border-top: 1px solid var(--light-gray);
}
    </style>
</head>
<body>
    <!-- Login Page -->
    <div id="loginPage" class="login-container">
        <div class="login-form">
            <h2>Shabdaanjali Login</h2>
            <div id="userLoginForm">
                <div class="form-group">
                    <label for="userEmail">Email</label>
                    <input type="email" id="userEmail" placeholder="Enter your email">
                </div>
                <button class="login-btn" onclick="loginUser()">Login as User</button>
                <div class="form-switch">
                    <a onclick="showAdminLogin()">Admin Login</a>
                </div>
            </div>
            
            <div id="adminLoginForm" class="hidden">
                <div class="form-group">
                    <label for="adminUsername">Username</label>
                    <input type="text" id="adminUsername" placeholder="Admin username">
                </div>
                <div class="form-group">
                    <label for="adminPassword">Password</label>
                    <input type="password" id="adminPassword" placeholder="Admin password">
                </div>
                <button class="login-btn" onclick="loginAdmin()">Login as Admin</button>
                <div class="form-switch">
                    <a onclick="showUserLogin()">User Login</a>
                </div>
            </div>
        </div>
    </div>
    
    <!-- User Dashboard -->
    <div id="userDashboard" class="user-dashboard hidden">
        <div class="user-header">
            <h2>Public Consultation Portal</h2>
            <p>Submit your feedback on the Companies (Amendment) Bill, 2023</p>
        </div>
        
        <div class="complaint-form">
            <h3>Submit Your Feedback</h3>
            <div class="form-row">
                <div class="form-half">
                    <div class="form-group">
                        <label for="userName">Full Name</label>
                        <input type="text" id="userName" placeholder="Enter your name">
                    </div>
                </div>
                <div class="form-half">
                    <div class="form-group">
                        <label for="userOrganization">Organization (Optional)</label>
                        <input type="text" id="userOrganization" placeholder="Enter organization name">
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label for="userClause">Related Clause/Section</label>
                <select id="userClause">
                    <option value="">Select a clause</option>
                    <option value="Clause 7: CSR Provisions">Clause 7: CSR Provisions</option>
                    <option value="Rule 12: Audit Requirements">Rule 12: Audit Requirements</option>
                    <option value="Section 4(1)(a): Reporting Timeline">Section 4(1)(a): Reporting Timeline</option>
                    <option value="General: Overall Legislation">General: Overall Legislation</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="userComment">Your Feedback</label>
                <textarea id="userComment" placeholder="Please provide your detailed feedback here..."></textarea>
            </div>
            
            <div class="form-group">
                <label>Upload Supporting Documents (Optional)</label>
                <div class="file-upload" onclick="document.getElementById('fileInput').click()">
                    <i class="fas fa-cloud-upload-alt" style="font-size: 24px; margin-bottom: 10px;"></i>
                    <p>Click to upload or drag and drop</p>
                    <p style="font-size: 12px; color: var(--gray);">PDF, DOC, DOCX (Max 5MB each)</p>
                </div>
                <input type="file" id="fileInput" multiple style="display: none;" onchange="handleFileUpload()">
                
                <div class="file-list" id="fileList">
                    <!-- Uploaded files will appear here -->
                </div>
            </div>
            
            <button class="btn btn-primary" onclick="submitFeedback()">
                <i class="fas fa-paper-plane"></i> Submit Feedback
            </button>
        </div>
        
        
    </div>
    
    <!-- Admin Dashboard -->
    <div id="adminDashboard" class="app-container hidden">
        <button class="menu-toggle" id="menuToggle">
            <i class="fas fa-bars"></i>
        </button>
        
        <div class="sidebar" id="sidebar">
            <div class="logo">
                <h1><i class="fas fa-brain"></i> <span>Shabdaanjali</span></h1>
            </div>
            <div class="menu-item active" onclick="showSection('dashboard')">
                <i class="fas fa-home"></i>
                <span>Dashboard</span>
            </div>
            <div class="menu-item" onclick="showSection('consultations')">
                <i class="fas fa-comments"></i>
                <span>Consultations</span>
            </div>
            <div class="menu-item" onclick="showSection('analytics')">
                <i class="fas fa-chart-bar"></i>
                <span>Analytics</span>
            </div>
            <div class="menu-item" onclick="showSection('stakeholders')">
                <i class="fas fa-users"></i>
                <span>Stakeholders</span>
            </div>
            <div class="menu-item" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i>
                <span>Logout</span>
            </div>
        </div>
        
        <!-- Main Content -->
        <div class="main-content">
            <!-- Dashboard Section -->
            <div id="dashboardSection">
                <div class="header">
                    <h2>E-Consultation Analysis Dashboard</h2>
                    <div class="user-info">
                        <img src="https://ui-avatars.com/api/?name=MoCA+Admin&background=0D8ABC&color=fff" alt="User" style="width: 40px; height: 40px; border-radius: 50%;">
                    </div>
                </div>
                
                <div class="consultation-info">
                    <h3>Companies (Amendment) Bill, 2023</h3>
                    <p>Analysis of 2,347 public comments received between Jan 15 - Feb 28, 2023</p>
                </div>
                
                <div class="dashboard-cards">
                    <div class="card stat-card">
                        <div class="label">TOTAL COMMENTS</div>
                        <div class="value">2,347</div>
                        <div class="trend up">
                            <i class="fas fa-arrow-up"></i>
                            <span>12% from previous consultation</span>
                        </div>
                    </div>
                    
                    <div class="card stat-card">
                        <div class="label">KEY STAKEHOLDERS</div>
                        <div class="value">38</div>
                        <div class="trend up">
                            <i class="fas fa-arrow-up"></i>
                            <span>8% more engaged</span>
                        </div>
                    </div>
                    
                    <div class="card stat-card">
                        <div class="label">ACTIONABLE SUGGESTIONS</div>
                        <div class="value">217</div>
                        <div class="trend up">
                            <i class="fas fa-arrow-up"></i>
                            <span>24% higher quality</span>
                        </div>
                    </div>
                    
                    <div class="card stat-card">
                        <div class="label">COORDINATED CAMPAIGNS</div>
                        <div class="value">14</div>
                        <div class="trend down">
                            <i class="fas fa-arrow-down"></i>
                            <span>3% less than last time</span>
                        </div>
                    </div>
                </div>
                
                <div class="chart-container">
                    <div class="chart-header">
                        <div class="chart-title">Sentiment Analysis by Clause</div>
                        <div class="chart-actions">
                            <button class="btn btn-outline" id="exportBtn">
                                <i class="fas fa-download"></i> Export
                            </button>
                            <button class="btn btn-primary" id="filterStakeholdersBtn">
                                <i class="fas fa-filter"></i> Filter Key Stakeholders
                            </button>
                        </div>
                    </div>
                    <div style="height: 300px; position: relative;">
                        <canvas id="sentimentChart"></canvas>
                    </div>
                </div>
                
                <div class="comments-section">
                    <div class="chart-header">
                        <div class="chart-title">Recent Comments</div>
                        <div class="chart-actions">
                            <button class="btn btn-primary" id="showActionableBtn">
                                <i class="fas fa-lightbulb"></i> Show Actionable Suggestions
                            </button>
                        </div>
                    </div>
                    
                    <div class="filters">
                        <div class="filter-group">
                            <div class="filter-label">SENTIMENT</div>
                            <select id="sentimentFilter">
                                <option value="all">All Sentiments</option>
                                <option value="positive">Positive</option>
                                <option value="negative">Negative</option>
                                <option value="neutral">Neutral</option>
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <div class="filter-label">STAKEHOLDER TYPE</div>
                            <select id="stakeholderFilter">
                                <option value="all">All Stakeholders</option>
                                <option value="key">Key Stakeholders</option>
                                <option value="industry">Industry Bodies</option>
                                <option value="individual">Individual Citizens</option>
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <div class="filter-label">CLAUSE</div>
                            <select id="clauseFilter">
                                <option value="all">All Clauses</option>
                                <option value="clause7">Clause 7 - CSR Provisions</option>
                                <option value="rule12">Rule 12 - Audit Requirements</option>
                                <option value="section4">Section 4(1)(a) - Reporting Timeline</option>
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <div class="filter-label">COMMENT TYPE</div>
                            <select id="typeFilter">
                                <option value="all">All Types</option>
                                <option value="actionable">Actionable Suggestions</option>
                                <option value="complaint">Complaints</option>
                                <option value="query">Queries</option>
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <div class="filter-label">SEARCH</div>
                            <input type="text" id="searchInput" placeholder="Search comments...">
                        </div>
                    </div>
                    
                    <div class="comments-list" id="commentsList">
                        <!-- Comments will be dynamically inserted here -->
                    </div>
                    
                    <div class="pagination" id="pagination">
                        <!-- Pagination will be dynamically inserted here -->
                    </div>
                </div>
            </div>
            
            <!-- Analytics Section -->
           <div id="analyticsSection">
    <div class="header">
        <h2>AI-Powered Analytics</h2>
        <div class="chart-actions">
            <button class="btn btn-primary" onclick="generatePDF()">
                <i class="fas fa-download"></i> Download PDF Report
            </button>
        </div>
    </div>
    
    <div class="analytics-summary">
        <h3>AI Analysis Summary</h3>
        <div class="ai-insight">
            <h4><i class="fas fa-robot"></i> Sentiment Insights</h4>
            <p>Sentiment analysis of the complaint reveals a strong negative tone (≈70%) 
               centered around privacy risks, licensing burdens, and overbroad definitions. 
               Positive sentiment (≈20%) acknowledges the need for reform and DoT’s public 
               consultation approach, while neutral/constructive sentiment (≈10%) provides 
               technical clarifications and global best practice references.</p>
        </div>
        
        <div class="summary-grid">
            <div class="summary-item">
                <h4>Sentiment Breakdown</h4>
                <ul>
                    <li><b>Negative:</b> 70% (privacy, licensing, shutdowns)</li>
                    <li><b>Positive:</b> 20% (consultation, modernization)</li>
                    <li><b>Neutral:</b> 10% (jurisdiction clarifications, best practices)</li>
                </ul>
            </div>
            
            <div class="summary-item">
                <h4>Top Negative Concerns</h4>
                <ul>
                    <li>Overbroad definitions → “one-size-fits-all” regulation</li>
                    <li>Unjustified licensing of OTT/digital services</li>
                    <li>Privacy threats from interception & ID verification</li>
                    <li>Risk of blanket internet shutdowns</li>
                </ul>
            </div>
            
            <div class="summary-item">
                <h4>Positive & Neutral Highlights</h4>
                <ul>
                    <li>Commendation of DoT’s consultative approach</li>
                    <li>Acknowledges telecom law modernization</li>
                    <li>Calls for alignment with TRAI, ITU, EU practices</li>
                </ul>
            </div>
        </div>
    </div>
    
    <!-- Charts -->
    <div class="chart-container">
        <div class="chart-header">
            <div class="chart-title">Sentiment Distribution</div>
        </div>
        <div style="height: 300px; position: relative;">
            <canvas id="sentimentChart"></canvas>
        </div>
    </div>
    
    <div class="chart-container">
        <div class="chart-header">
            <div class="chart-title">Sentiment Trend Over Time</div>
        </div>
        <div style="height: 300px; position: relative;">
            <canvas id="trendChart"></canvas>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// Sentiment Distribution (Pie)
const ctxSentiment = document.getElementById('sentimentChart').getContext('2d');
new Chart(ctxSentiment, {
    type: 'pie',
    data: {
        labels: ["Negative (70%)", "Positive (20%)", "Neutral (10%)"],
        datasets: [{
            data: [70, 20, 10],
            backgroundColor: ["#e15759", "#59a14f", "#bab0ac"]
        }]
    },
    options: {
        responsive: true,
        plugins: { legend: { position: 'bottom' } }
    }
});

// Sentiment Trend (Line)
const ctxTrend = document.getElementById('trendChart').getContext('2d');
new Chart(ctxTrend, {
    type: 'line',
    data: {
        labels: ["Week 1", "Week 2", "Week 3", "Week 4"],
        datasets: [
            { label: "Negative", data: [65, 68, 72, 70], borderColor: "red", fill: false },
            { label: "Positive", data: [25, 22, 18, 20], borderColor: "green", fill: false },
            { label: "Neutral", data: [10, 10, 10, 10], borderColor: "gray", fill: false }
        ]
    },
    options: {
        responsive: true,
        plugins: { legend: { position: 'bottom' } }
    }
});
</script>

    
    <!-- Modal for comment analysis -->
    <div class="modal" id="analysisModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Comment Analysis</h3>
                <button class="close-modal" id="closeModal">&times;</button>
            </div>
            <div id="modalContent">
                <!-- Modal content will be dynamically inserted here -->
            </div>
        </div>
    </div>

    <script>
        // Sample data for the application
        const sampleComments = [
            {
                id: 1,
                source: "Institute of Chartered Accountants of India (ICAI)",
                isKeyStakeholder: true,
                sentiment: "negative",
                clause: "Clause 7: Corporate Social Responsibility (CSR) Reporting Requirements",
                text: "While the intention to enhance transparency in CSR spending is commendable, the proposed amendment may create unintended compliance burdens for smaller companies. We urge reconsideration of the mandatory disclosure requirements for companies with less than ₹50 crore net profit.",
                type: "actionable",
                campaign: false,
                date: "2023-02-15",
                analysis: {
                    sentimentScore: -0.8,
                    keyPhrases: ["compliance burdens", "smaller companies", "mandatory disclosure requirements"],
                    suggestedAction: "Consider threshold-based application of disclosure requirements",
                    impact: "High",
                    relevance: "Very Relevant"
                }
            },
            {
                id: 2,
                source: "Federation of Indian Chambers of Commerce & Industry (FICCI)",
                isKeyStakeholder: true,
                sentiment: "negative",
                clause: "Rule 12: Enhanced Audit Requirements",
                text: "The proposed audit requirements would significantly increase compliance costs without corresponding benefits to stakeholders. We recommend a phased implementation approach and raising the threshold for application to companies with turnover below ₹500 crore.",
                type: "actionable",
                campaign: true,
                similarCount: 127,
                date: "2023-02-18",
                analysis: {
                    sentimentScore: -0.7,
                    keyPhrases: ["compliance costs", "phased implementation", "threshold for application"],
                    suggestedAction: "Consider phased implementation and review applicability thresholds",
                    impact: "High",
                    relevance: "Very Relevant"
                }
            },
            {
                id: 3,
                source: "Rajesh Kumar",
                isKeyStakeholder: false,
                sentiment: "positive",
                clause: "General: Overall Legislation",
                text: "This is a great step towards corporate transparency. I fully support the government's initiative to make companies more accountable to stakeholders and the public.",
                type: "praise",
                campaign: false,
                date: "2023-01-20",
                analysis: {
                    sentimentScore: 0.9,
                    keyPhrases: ["corporate transparency", "accountable to stakeholders"],
                    suggestedAction: "None - general support comment",
                    impact: "Low",
                    relevance: "General"
                }
            },
            {
                id: 4,
                source: "Small Business Association",
                isKeyStakeholder: false,
                sentiment: "negative",
                clause: "Section 4(1)(a): Reporting Timeline",
                text: "The 30-day reporting requirement is impractical for small businesses with limited resources. We recommend extending the timeline to 60 days to allow for proper compilation and verification of required information.",
                type: "actionable",
                campaign: true,
                similarCount: 84,
                date: "2023-02-10",
                analysis: {
                    sentimentScore: -0.6,
                    keyPhrases: ["impractical for small businesses", "extending the timeline", "proper compilation"],
                    suggestedAction: "Consider extended timeline for small businesses",
                    impact: "Medium",
                    relevance: "Relevant"
                }
            },
            {
                id: 5,
                source: "Environmental Action Group",
                isKeyStakeholder: true,
                sentiment: "positive",
                clause: "Clause 7: Corporate Social Responsibility (CSR) Reporting Requirements",
                text: "We applaud the enhanced CSR reporting requirements. This will ensure companies are more accountable for their social and environmental commitments. However, we suggest including specific metrics for environmental impact assessment.",
                type: "actionable",
                campaign: false,
                date: "2023-02-22",
                analysis: {
                    sentimentScore: 0.7,
                    keyPhrases: ["enhanced CSR reporting", "environmental impact assessment", "specific metrics"],
                    suggestedAction: "Include environmental impact assessment metrics in reporting requirements",
                    impact: "Medium",
                    relevance: "Relevant"
                }
            },
            {
                id: 6,
                source: "National Corporate Lawyers Association",
                isKeyStakeholder: true,
                sentiment: "neutral",
                clause: "Rule 12: Enhanced Audit Requirements",
                text: "The proposed audit requirements align with international standards but may require additional clarification on the scope of auditor liabilities. We suggest publishing detailed guidelines for implementation.",
                type: "query",
                campaign: false,
                date: "2023-02-05",
                analysis: {
                    sentimentScore: 0.1,
                    keyPhrases: ["international standards", "auditor liabilities", "detailed guidelines"],
                    suggestedAction: "Provide clarification on auditor liabilities and publish implementation guidelines",
                    impact: "Medium",
                    relevance: "Relevant"
                }
            }
        ];

        // Chart data
        const chartData = {
            labels: ['Clause 7 - CSR', 'Rule 12 - Audit', 'Section 4 - Reporting', 'Clause 9 - Compliance', 'Section 12 - Penalties'],
            datasets: [
                {
                    label: 'Positive',
                    data: [65, 30, 45, 25, 20],
                    backgroundColor: '#34a853',
                },
                {
                    label: 'Neutral',
                    data: [20, 35, 25, 30, 25],
                    backgroundColor: '#fbbc04',
                },
                {
                    label: 'Negative',
                    data: [15, 35, 30, 45, 55],
                    backgroundColor: '#ea4335',
                }
            ]
        };

        // Trend chart data
        const trendData = {
            labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4', 'Week 5', 'Week 6'],
            datasets: [
                {
                    label: 'Positive',
                    data: [12, 19, 15, 25, 22, 30],
                    borderColor: '#34a853',
                    backgroundColor: 'rgba(52, 168, 83, 0.1)',
                    fill: true,
                    tension: 0.4
                },
                {
                    label: 'Neutral',
                    data: [20, 25, 22, 30, 28, 25],
                    borderColor: '#fbbc04',
                    backgroundColor: 'rgba(251, 188, 4, 0.1)',
                    fill: true,
                    tension: 0.4
                },
                {
                    label: 'Negative',
                    data: [25, 30, 35, 28, 32, 40],
                    borderColor: '#ea4335',
                    backgroundColor: 'rgba(234, 67, 53, 0.1)',
                    fill: true,
                    tension: 0.4
                }
            ]
        };

        // Stakeholder chart data
        const stakeholderData = {
            labels: ['Industry Associations', 'Corporate Bodies', 'Professional Institutes', 'Individual Citizens', 'NGOs', 'Law Firms'],
            datasets: [{
                data: [24, 32, 18, 26, 12, 8],
                backgroundColor: [
                    '#1a73e8',
                    '#34a853',
                    '#fbbc04',
                    '#ea4335',
                    '#9c27b0',
                    '#009688'
                ],
            }]
        };

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize charts
            initCharts();
            
            // Render comments
            renderComments(sampleComments);
            
            // Setup event listeners
            setupEventListeners();
        });

        function initCharts() {
            // Sentiment chart
            const ctx = document.getElementById('sentimentChart').getContext('2d');
            const sentimentChart = new Chart(ctx, {
                type: 'bar',
                data: chartData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            stacked: true,
                        },
                        y: {
                            stacked: true,
                            max: 100,
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.raw + '%';
                                }
                            }
                        }
                    }
                }
            });
            
            // Trend chart
            const trendCtx = document.getElementById('trendChart').getContext('2d');
            const trendChart = new Chart(trendCtx, {
                type: 'line',
                data: trendData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Number of Comments'
                            }
                        }
                    }
                }
            });
            
            // Stakeholder chart
            const stakeholderCtx = document.getElementById('stakeholderChart').getContext('2d');
            const stakeholderChart = new Chart(stakeholderCtx, {
                type: 'doughnut',
                data: stakeholderData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                        }
                    }
                }
            });
        }

        function setupEventListeners() {
            document.getElementById('exportBtn').addEventListener('click', function() {
                alert('Data exported successfully!');
            });
            
            document.getElementById('filterStakeholdersBtn').addEventListener('click', function() {
                const filteredComments = sampleComments.filter(comment => comment.isKeyStakeholder);
                renderComments(filteredComments);
                this.classList.toggle('active');
                
                if (!this.classList.contains('active')) {
                    renderComments(sampleComments);
                }
            });
            
            document.getElementById('showActionableBtn').addEventListener('click', function() {
                const filteredComments = sampleComments.filter(comment => comment.type === 'actionable');
                renderComments(filteredComments);
                alert('Showing ' + filteredComments.length + ' actionable suggestions');
            });
            
            // Filter event listeners
            document.getElementById('sentimentFilter').addEventListener('change', applyFilters);
            document.getElementById('stakeholderFilter').addEventListener('change', applyFilters);
            document.getElementById('clauseFilter').addEventListener('change', applyFilters);
            document.getElementById('typeFilter').addEventListener('change', applyFilters);
            document.getElementById('searchInput').addEventListener('input', applyFilters);
            
            // Modal functionality
            document.getElementById('closeModal').addEventListener('click', function() {
                document.getElementById('analysisModal').style.display = 'none';
            });
            
            // Close modal when clicking outside
            window.addEventListener('click', function(event) {
                if (event.target === document.getElementById('analysisModal')) {
                    document.getElementById('analysisModal').style.display = 'none';
                }
            });
            
            // Mobile menu toggle
            document.getElementById('menuToggle').addEventListener('click', function() {
                document.getElementById('sidebar').classList.toggle('active');
            });
        }
        
        // Function to render comments
        function renderComments(comments) {
            const commentsList = document.getElementById('commentsList');
            commentsList.innerHTML = '';
            
            if (comments.length === 0) {
                commentsList.innerHTML = '<p class="no-results">No comments match your filters.</p>';
                document.getElementById('pagination').innerHTML = '';
                return;
            }
            
            comments.forEach(comment => {
                const commentEl = document.createElement('div');
                commentEl.className = 'comment';
                
                // Determine sentiment class
                let sentimentClass = '';
                if (comment.sentiment === 'positive') sentimentClass = 'sentiment-positive';
                if (comment.sentiment === 'negative') sentimentClass = 'sentiment-negative';
                if (comment.sentiment === 'neutral') sentimentClass = 'sentiment-neutral';
                
                // Determine type class
                let typeClass = '';
                let typeText = '';
                if (comment.type === 'actionable') {
                    typeClass = 'type-actionable';
                    typeText = 'Actionable Suggestion';
                } else if (comment.type === 'complaint') {
                    typeClass = 'type-complaint';
                    typeText = 'Complaint';
                } else if (comment.type === 'praise') {
                    typeClass = 'type-complaint';
                    typeText = 'Praise';
                } else {
                    typeClass = 'type-actionable';
                    typeText = 'Query';
                }
                
                commentEl.innerHTML = `
                    <div class="comment-header">
                        <div class="comment-source">
                            <i class="${comment.source.includes('Individual') ? 'fas fa-user' : 'fas fa-building'}"></i>
                            ${comment.source}
                            ${comment.isKeyStakeholder ? '<span class="key-stakeholder">Key Stakeholder</span>' : ''}
                        </div>
                        <div class="comment-sentiment ${sentimentClass}">${comment.sentiment.charAt(0).toUpperCase() + comment.sentiment.slice(1)}</div>
                    </div>
                    <div class="comment-clause">
                        <strong>${comment.clause.split(':')[0]}:</strong> ${comment.clause.split(':')[1]}
                    </div>
                    <div class="comment-text">
                        "${comment.text}"
                    </div>
                    <div class="comment-footer">
                        <div class="comment-type">
                            <span class="type-badge ${typeClass}">${typeText}</span>
                            ${comment.campaign ? `<span class="campaign-badge" data-id="${comment.id}">Coordinated Campaign (${comment.similarCount} similar)</span>` : ''}
                        </div>
                        <div class="comment-actions">
                            <button class="action-btn view-analysis" data-id="${comment.id}">
                                <i class="far fa-eye"></i> View Analysis
                            </button>
                            <button class="action-btn">
                                <i class="far fa-flag"></i> Flag
                            </button>
                        </div>
                    </div>
                `;
                
                commentsList.appendChild(commentEl);
            });
            
            // Add event listeners to view analysis buttons
            document.querySelectorAll('.view-analysis').forEach(button => {
                button.addEventListener('click', function() {
                    const commentId = this.getAttribute('data-id');
                    showAnalysisModal(commentId);
                });
            });
            
            // Add event listeners to campaign badges
            document.querySelectorAll('.campaign-badge').forEach(badge => {
                badge.addEventListener('click', function() {
                    const commentId = this.getAttribute('data-id');
                    alert(`Showing cluster analysis for comment ${commentId} and ${sampleComments.find(c => c.id == commentId).similarCount} similar comments`);
                });
            });
            
            // Simple pagination (for demo purposes)
            updatePagination();
        }
        
        // Function to apply filters
        function applyFilters() {
            const sentimentFilter = document.getElementById('sentimentFilter').value;
            const stakeholderFilter = document.getElementById('stakeholderFilter').value;
            const clauseFilter = document.getElementById('clauseFilter').value;
            const typeFilter = document.getElementById('typeFilter').value;
            const searchText = document.getElementById('searchInput').value.toLowerCase();
            
            let filteredComments = sampleComments.filter(comment => {
                // Sentiment filter
                if (sentimentFilter !== 'all' && comment.sentiment !== sentimentFilter) {
                    return false;
                }
                
                // Stakeholder filter
                if (stakeholderFilter !== 'all') {
                    if (stakeholderFilter === 'key' && !comment.isKeyStakeholder) {
                        return false;
                    }
                    if (stakeholderFilter === 'industry' && !comment.source.includes('Association') && !comment.source.includes('Federation') && !comment.source.includes('Institute')) {
                        return false;
                    }
                    if (stakeholderFilter === 'individual' && !comment.source.includes('Individual')) {
                        return false;
                    }
                }
                
                // Clause filter
                if (clauseFilter !== 'all') {
                    if (clauseFilter === 'clause7' && !comment.clause.includes('Clause 7')) {
                        return false;
                    }
                    if (clauseFilter === 'rule12' && !comment.clause.includes('Rule 12')) {
                        return false;
                    }
                    if (clauseFilter === 'section4' && !comment.clause.includes('Section 4')) {
                        return false;
                    }
                }
                
                // Type filter
                if (typeFilter !== 'all' && comment.type !== typeFilter) {
                    return false;
                }
                
                // Search filter
                if (searchText && !comment.text.toLowerCase().includes(searchText) && 
                    !comment.source.toLowerCase().includes(searchText) && 
                    !comment.clause.toLowerCase().includes(searchText)) {
                    return false;
                }
                
                return true;
            });
            
            renderComments(filteredComments);
        }
        
        // Function to show analysis modal
        function showAnalysisModal(commentId) {
            const comment = sampleComments.find(c => c.id == commentId);
            if (!comment) return;
            
            const modal = document.getElementById('analysisModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalContent = document.getElementById('modalContent');
            
            modalTitle.textContent = `Analysis: ${comment.source}`;
            
            // Determine sentiment icon and color
            let sentimentIcon = '';
            let sentimentColor = '';
            if (comment.sentiment === 'positive') {
                sentimentIcon = 'fa-smile';
                sentimentColor = 'color: #34a853;';
            } else if (comment.sentiment === 'negative') {
                sentimentIcon = 'fa-frown';
                sentimentColor = 'color: #ea4335;';
            } else {
                sentimentIcon = 'fa-meh';
                sentimentColor = 'color: #fbbc04;';
            }
            
            modalContent.innerHTML = `
                <div class="comment-clause">
                    <strong>${comment.clause}</strong>
                </div>
                <div class="comment-text">
                    "${comment.text}"
                </div>
                
                <h4>AI Analysis</h4>
                <div style="display: flex; align-items: center; margin: 15px 0;">
                    <div style="font-size: 24px; ${sentimentColor} margin-right: 10px;">
                        <i class="far ${sentimentIcon}"></i>
                    </div>
                    <div>
                        <strong>Sentiment Score:</strong> ${comment.analysis.sentimentScore.toFixed(2)}
                    </div>
                </div>
                
                <div class="analysis-tags">
                    ${comment.analysis.keyPhrases.map(phrase => 
                        `<span class="analysis-tag">${phrase}</span>`
                    ).join('')}
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 15px 0;">
                    <div>
                        <strong>Suggested Action:</strong>
                        <p>${comment.analysis.suggestedAction}</p>
                    </div>
                    <div>
                        <strong>Impact Level:</strong>
                        <p>${comment.analysis.impact}</p>
                    </div>
                    <div>
                        <strong>Relevance:</strong>
                        <p>${comment.analysis.relevance}</p>
                    </div>
                    <div>
                        <strong>Submission Date:</strong>
                        <p>${comment.date}</p>
                    </div>
                </div>
                
                ${comment.campaign ? `
                <div style="background: #f5f5f5; padding: 10px; border-radius: 4px; margin: 15px 0;">
                    <strong><i class="fas fa-users"></i> Coordinated Campaign Detected</strong>
                    <p>This comment is part of a coordinated campaign with ${comment.similarCount} similar submissions.</p>
                    <button class="btn btn-outline" style="margin-top: 8px;">
                        <i class="fas fa-chart-network"></i> View Campaign Analysis
                    </button>
                </div>
                ` : ''}
                
                <div style="margin-top: 20px;">
                    <button class="btn btn-primary">
                        <i class="fas fa-check-circle"></i> Mark as Reviewed
                    </button>
                    <button class="btn btn-outline">
                        <i class="fas fa-share"></i> Share with Team
                    </button>
                </div>
            `;
            
            modal.style.display = 'flex';
        }
        
        // Function to update pagination
        function updatePagination() {
            const pagination = document.getElementById('pagination');
            pagination.innerHTML = '';
            
            // Simple pagination for demo
            for (let i = 1; i <= 5; i++) {
                const pageBtn = document.createElement('button');
                pageBtn.className = i === 1 ? 'page-btn active' : 'page-btn';
                pageBtn.textContent = i;
                pageBtn.addEventListener('click', function() {
                    document.querySelectorAll('.page-btn').forEach(btn => btn.classList.remove('active'));
                    this.classList.add('active');
                });
                pagination.appendChild(pageBtn);
            }
        }
        
        // Login functions
        function showAdminLogin() {
            document.getElementById('userLoginForm').classList.add('hidden');
            document.getElementById('adminLoginForm').classList.remove('hidden');
        }
        
        function showUserLogin() {
            document.getElementById('adminLoginForm').classList.add('hidden');
            document.getElementById('userLoginForm').classList.remove('hidden');
        }
        
        function loginUser() {
    const email = document.getElementById('userEmail').value;
    if (email) {
        document.getElementById('loginPage').classList.add('hidden');
        document.getElementById('userDashboard').classList.remove('hidden');
        
        // Load user submissions
        loadUserSubmissions(email);
    } else {
        alert('Please enter your email');
    }
}

// Add this to your existing initialization code
async function loadAnalyzedComments() {
    try {
        const response = await fetch('/api/analytics/comments');
        const comments = await response.json();
        
        // Update your comments rendering to use the real data
        renderComments(comments);
    } catch (error) {
        console.error('Error loading comments:', error);
    }
}

async function loadAnalyticsSummary() {
    try {
        const response = await fetch('/api/analytics/summary');
        const summary = await response.json();
        
        // Update your dashboard cards with real data
        document.querySelector('.stat-card .value').textContent = summary.total_comments;
        document.querySelectorAll('.stat-card .value')[1].textContent = summary.key_stakeholders;
        document.querySelectorAll('.stat-card .value')[2].textContent = summary.actionable_suggestions;
        document.querySelectorAll('.stat-card .value')[3].textContent = summary.coordinated_campaigns;
        
        // Update charts with real data
        updateChartsWithRealData(summary);
    } catch (error) {
        console.error('Error loading analytics:', error);
    }
}

// Call these functions when admin logs in
function loginAdmin() {
    const username = document.getElementById('adminUsername').value;
    const password = document.getElementById('adminPassword').value;
    
    if (username === 'admin' && password === 'password') {
        document.getElementById('loginPage').classList.add('hidden');
        document.getElementById('adminDashboard').classList.remove('hidden');
        
        // Load real data
        loadAnalyzedComments();
        loadAnalyticsSummary();
    } else {
        alert('Invalid admin credentials');
    }
}
// Add these functions for the new modals
function showNewConsultationModal() {
    document.getElementById('newConsultationModal').style.display = 'flex';
}

function showImportModal() {
    document.getElementById('importStakeholdersModal').style.display = 'flex';
}

function closeModal(modalId) {
    document.getElementById(modalId).style.display = 'none';
}

function createConsultation() {
    const title = document.getElementById('consultationTitle').value;
    const description = document.getElementById('consultationDescription').value;
    const startDate = document.getElementById('startDate').value;
    const endDate = document.getElementById('endDate').value;
    
    if (!title || !description || !startDate || !endDate) {
        alert('Please fill in all required fields');
        return;
    }
    
    // In a real implementation, you would send this data to the server
    alert(`Consultation "${title}" created successfully!`);
    closeModal('newConsultationModal');
    
    // Reset form
    document.getElementById('consultationTitle').value = '';
    document.getElementById('consultationDescription').value = '';
    document.getElementById('startDate').value = '';
    document.getElementById('endDate').value = '';
}

function importStakeholders() {
    const fileInput = document.getElementById('stakeholderFileInput');
    const category = document.getElementById('importCategory').value;
    const sendEmail = document.getElementById('sendWelcomeEmail').checked;
    
    if (!fileInput.files.length) {
        alert('Please select a CSV file to import');
        return;
    }
    
    // In a real implementation, you would upload the file to the server
    alert(`Stakeholders imported successfully! Category: ${category}, Send Email: ${sendEmail}`);
    closeModal('importStakeholdersModal');
    
    // Reset form
    fileInput.value = '';
}        
        function loginAdmin() {
            const username = document.getElementById('adminUsername').value;
            const password = document.getElementById('adminPassword').value;
            
            if (username === 'admin' && password === 'password') {
                document.getElementById('loginPage').classList.add('hidden');
                document.getElementById('adminDashboard').classList.remove('hidden');
            } else {
                alert('Invalid admin credentials');
            }
        }
        
        function logout() {
            document.getElementById('adminDashboard').classList.add('hidden');
            document.getElementById('userDashboard').classList.add('hidden');
            document.getElementById('loginPage').classList.remove('hidden');
            
            // Reset forms
            document.getElementById('userEmail').value = '';
            document.getElementById('adminUsername').value = '';
            document.getElementById('adminPassword').value = '';
            showUserLogin();
        }
        
        // Section navigation
        function showSection(sectionId) {
            // Hide all sections
            document.getElementById('dashboardSection').classList.add('hidden');
            document.getElementById('consultationsSection').classList.add('hidden');
            document.getElementById('analyticsSection').classList.add('hidden');
            document.getElementById('stakeholdersSection').classList.add('hidden');
            
            // Show selected section
            document.getElementById(sectionId + 'Section').classList.remove('hidden');
            
            // Update menu items
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Find and activate the clicked menu item
            const menuItems = document.querySelectorAll('.menu-item');
            for (let item of menuItems) {
                if (item.textContent.includes(sectionId.charAt(0).toUpperCase() + sectionId.slice(1))) {
                    item.classList.add('active');
                    break;
                }
            }
        }
        
        // File upload handling
        function handleFileUpload() {
    const fileInput = document.getElementById('fileInput');
    const fileList = document.getElementById('fileList');
    
    fileList.innerHTML = '';
    
    for (let file of fileInput.files) {
        const fileItem = document.createElement('div');
        fileItem.className = 'file-item';
        
        // Determine file icon based on extension
        let fileIcon = 'fa-file';
        let fileColor = '#5f6368';
        
        if (file.name.toLowerCase().endsWith('.pdf')) {
            fileIcon = 'fa-file-pdf';
            fileColor = '#ea4335';
        } else if (file.name.toLowerCase().endsWith('.doc') || file.name.toLowerCase().endsWith('.docx')) {
            fileIcon = 'fa-file-word';
            fileColor = '#1a73e8';
        }
        
        fileItem.innerHTML = `
            <div>
                <i class="fas ${fileIcon}" style="color: ${fileColor};"></i> 
                ${file.name} (${(file.size / 1024).toFixed(1)} KB)
            </div>
            <div class="file-remove" onclick="removeFile(this)">
                <i class="fas fa-times"></i>
            </div>
        `;
        fileList.appendChild(fileItem);
    }
}
        
        function removeFile(element) {
            const fileItem = element.parentElement;
            fileItem.remove();
        }
        
        async function submitFeedback() {
    const name = document.getElementById('userName').value;
    const email = document.getElementById('userEmail').value;
    const organization = document.getElementById('userOrganization').value;
    const clause = document.getElementById('userClause').value;
    const comment = document.getElementById('userComment').value;
    
    if (!name || !email || !clause || !comment) {
        alert('Please fill in all required fields');
        return;
    }
    
    // Create form data
    const formData = new FormData();
    formData.append('name', name);
    formData.append('email', email);
    formData.append('organization', organization);
    formData.append('clause', clause);
    formData.append('comment', comment);
    
    // Add files if any
    const fileInput = document.getElementById('fileInput');
    for (let i = 0; i < fileInput.files.length; i++) {
        formData.append('files', fileInput.files[i]);
    }
    
    try {
        const response = await fetch('/api/submit-feedback', {
            method: 'POST',
            body: formData
        });
        
        const result = await response.json();
        
        if (result.success) {
            alert('Thank you for your feedback! Your submission has been received and analyzed.');
            // Reset form
            document.getElementById('userName').value = '';
            document.getElementById('userOrganization').value = '';
            document.getElementById('userClause').value = '';
            document.getElementById('userComment').value = '';
            document.getElementById('fileList').innerHTML = '';
            
            // Reload user submissions
            loadUserSubmissions(email);
        } else {
            alert('Error submitting feedback: ' + result.error);
        }
    } catch (error) {
        alert('Error submitting feedback. Please try again.');
        console.error('Error:', error);
    }
}

function viewSubmissionAnalysis(submissionId) {
    // In a real implementation, you would fetch the specific submission details
    alert(`Viewing analysis for submission ${submissionId}. This would show detailed analysis from the backend.`);
}

async function loadUserSubmissions(email) {
    try {
        const response = await fetch(`/api/user-submissions/${email}`);
        const submissions = await response.json();
        
        const submissionsContainer = document.getElementById('userSubmissions');
        submissionsContainer.innerHTML = '';
        
        if (submissions.length === 0) {
            submissionsContainer.innerHTML = '<p>You have not submitted any feedback yet.</p>';
            return;
        }
        
        submissions.forEach(submission => {
            const submissionCard = document.createElement('div');
            submissionCard.className = 'complaint-card';
            
            // Determine status class
            let statusClass = 'status-pending';
            let statusText = 'Pending';
            
            if (submission.status === 'reviewed') {
                statusClass = 'status-reviewed';
                statusText = 'Reviewed';
            } else if (submission.status === 'rejected') {
                statusClass = 'status-rejected';
                statusText = 'Rejected';
            }
            
            submissionCard.innerHTML = `
                <span class="complaint-status ${statusClass}">${statusText}</span>
                <h4>${submission.clause}</h4>
                <p>${submission.text.substring(0, 200)}...</p>
                <p class="comment-clause">Submitted on: ${submission.date}</p>
                <button class="btn btn-outline" onclick="viewSubmissionAnalysis('${submission.id}')">
                    <i class="fas fa-chart-bar"></i> View Analysis
                </button>
            `;
            
            submissionsContainer.appendChild(submissionCard);
        });
    } catch (error) {
        console.error('Error loading submissions:', error);
    }
}
        
        // PDF generation
        function generatePDF() {
            // Using html2canvas and jsPDF
            const { jsPDF } = window.jspdf;
            
            const element = document.getElementById('analyticsSection');
            
            html2canvas(element).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const pdf = new jsPDF('p', 'mm', 'a4');
                const imgProps = pdf.getImageProperties(imgData);
                const pdfWidth = pdf.internal.pageSize.getWidth();
                const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;
                
                pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);
                pdf.save('analytics-report.pdf');
            });
        }
    </script>
</body>
</html>